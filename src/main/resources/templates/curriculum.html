<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Müfredat Oluştur</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/side.css">
</head>
<div th:replace="fragments/courses-navbar :: navbar"></div>
<body class="bg-light">
<div class="wrapper">
    <div th:insert="fragments/sidebar :: instructorSidebar('curriculum')"></div>

    <div class="container my-4" id="sections-container">
        <h4 class="fw-semibold" style="font-family: Georgia, Times, serif; margin-left: 20px;">Müfredat</h4>
        <hr class="w-150 border-1 opacity-75">

        <div class="section-container">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Bölüm 1: Giriş</h5>

                    <div class="border rounded p-3 mb-3 d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center gap-2">
                            <span>Ders 1:</span>
                            <input type="text" class="form-control form-control-sm" value="Giriş" style="width: 200px;">
                            <span class="text-primary" role="button">&#9998;</span>
                            <span class="text-danger" role="button">&#10060;</span>
                        </div>
                        <div>
                            <button class="btn btn-sm btn-outline-primary" onclick="toggleContentOptions(this)">+
                                İçerik
                            </button>
                            <div class="mt-2 p-2 border rounded bg-white d-none content-panel">
                                <div class="mb-2">
                                    <button class="btn btn-sm btn-secondary me-2"
                                            onclick="toggleSpecificPanel(this, 'article')">Makale
                                    </button>
                                    <button class="btn btn-sm btn-secondary"
                                            onclick="toggleSpecificPanel(this, 'video')">Video
                                    </button>
                                </div>
                                <div class="mt-2 video-upload d-none">
                                    <h6>Video Yükle</h6>
                                    <input type="file" class="form-control" accept="video/*">
                                </div>
                                <div class="mt-2 article-panel d-none">
                                    <label class="form-label">Metin</label>
                                    <textarea class="form-control mb-2" placeholder="Açıklama yazın..."></textarea>
                                    <button class="btn btn-success btn-sm">Kaydet</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-outline-success mb-3" onclick="toggleCurriculumItemPanel(this)">+ Müfredat
                        Öğesi
                    </button>
                    <div class="d-none mt-2 curriculum-panel">
                        <div class="d-flex gap-2 mb-3">
                            <button class="btn btn-outline-primary" onclick="showOnlyPanel(this, 'lesson')">+ Ders
                            </button>
                            <button class="btn btn-outline-primary" onclick="showOnlyPanel(this, 'exam')">+ Sınav
                            </button>
                            <button class="btn btn-outline-primary" onclick="showOnlyPanel(this, 'coding')">+ Kodlama
                                Alıştırması
                            </button>
                            <button class="btn btn-outline-primary" onclick="showOnlyPanel(this, 'homework')">+ Ödev
                            </button>
                        </div>

                        <div class="panel-lesson d-none border p-3 rounded bg-white">
                            <label class="form-label">Yeni Ders</label>
                            <input type="text" class="form-control mb-2" placeholder="Başlık Girin">
                            <div class="d-flex gap-2">
                                <button class="btn btn-secondary btn-sm" onclick="hideParentPanel(this)">İptal</button>
                                <button class="btn btn-success btn-sm">Ders Ekle</button>
                            </div>
                        </div>

                        <div class="panel-exam d-none border p-3 rounded bg-white">
                            <label class="form-label">Yeni Test</label>
                            <input type="text" class="form-control mb-2" placeholder="Başlık Girin">
                            <label class="form-label">Açıklama</label>
                            <textarea class="form-control mb-2" placeholder="Açıklama yazın..."></textarea>
                            <div class="d-flex gap-2">
                                <button class="btn btn-secondary btn-sm" onclick="hideParentPanel(this)">İptal</button>
                                <button class="btn btn-success btn-sm">Sınav Ekle</button>
                            </div>
                        </div>

                        <div class="panel-coding d-none border p-3 rounded bg-white">
                            <label class="form-label">Kodlama Alıştırması</label>
                            <input type="text" class="form-control mb-2" placeholder="Başlık Girin">
                            <div class="d-flex gap-2">
                                <button class="btn btn-secondary btn-sm" onclick="hideParentPanel(this)">İptal</button>
                                <button class="btn btn-success btn-sm">Kodlama Ekle</button>
                            </div>
                        </div>

                        <div class="panel-homework d-none border p-3 rounded bg-white">
                            <label class="form-label">Ödev</label>
                            <input type="text" class="form-control mb-2" placeholder="Başlık Girin">
                            <div class="d-flex gap-2">
                                <button class="btn btn-secondary btn-sm" onclick="hideParentPanel(this)">İptal</button>
                                <button class="btn btn-success btn-sm">Ödev Ekle</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="add-section-panel" class="d-none mb-4">
            <div class="card">
                <div class="card-body">
                    <label class="form-label">Yeni Bölüm</label>
                    <input type="text" class="form-control mb-3" id="new-section-title" placeholder="Başlık Girin">
                    <div class="d-flex justify-content-end gap-2">
                        <button class="btn btn-secondary btn-sm" onclick="cancelSectionPanel()">İptal</button>
                        <button class="btn btn-success btn-sm" onclick="addNewSection()">Bölüm Ekle</button>
                    </div>
                </div>
            </div>
        </div>
        <button class="btn btn-primary" onclick="showSectionPanel()">+ Bölüm</button>
    </div>
</div>
<script>
    function toggleContentOptions(btn) {
        const panel = btn.nextElementSibling;
        panel.classList.toggle("d-none");
    }

    function toggleSpecificPanel(btn, type) {
        const panel = btn.closest(".content-panel");
        const videoPanel = panel.querySelector(".video-upload");
        const articlePanel = panel.querySelector(".article-panel");

        if (type === "video") {
            videoPanel.classList.toggle("d-none");
            articlePanel.classList.add("d-none");
        } else if (type === "article") {
            articlePanel.classList.toggle("d-none");
            videoPanel.classList.add("d-none");
        }
    }

    function toggleCurriculumItemPanel(btn) {
        const panel = btn.nextElementSibling;
        panel.classList.toggle("d-none");
    }

    function showOnlyPanel(btn, type) {
        const container = btn.closest(".curriculum-panel");
        const panels = container.querySelectorAll('[class^="panel-"]');
        panels.forEach(panel => {
            if (panel.classList.contains(`panel-${type}`)) {
                panel.classList.remove("d-none");
            } else {
                panel.classList.add("d-none");
            }
        });
    }

    function hideParentPanel(btn) {
        const parentPanel = btn.closest('[class^="panel-"]');
        if (parentPanel) parentPanel.classList.add("d-none");
    }

    function showSectionPanel() {
        document.getElementById("add-section-panel").classList.remove("d-none");
    }

    function cancelSectionPanel() {
        document.getElementById("add-section-panel").classList.add("d-none");
        document.getElementById("new-section-title").value = "";
    }

    function addNewSection() {
        const title = document.getElementById("new-section-title").value;
        if (!title) return;

        const sectionTemplate = document.querySelector(".section-container");
        const newSection = sectionTemplate.cloneNode(true);

        newSection.querySelector(".card-title").textContent = title;
        newSection.querySelectorAll("input").forEach(input => input.value = "");
        newSection.querySelectorAll(".d-none").forEach(el => el.classList.add("d-none"));

        document.getElementById("sections-container").insertBefore(newSection, document.getElementById("add-section-panel"));
        cancelSectionPanel();
    }
</script>
</body>
</html>


